for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
labelx<- 0.8*max(sde$visits),
labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
size = 3, colour = "red"))
}
print(p1)
annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
labelx<- 0.8*max(sde$visits),
labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
size = 3, colour = "red"))
#
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = "plot mpg vs. wt")
}
print(p1)
labelx
labely
labely=15
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = "plot mpg vs. wt")
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
labelx<- 0.8*max(sde$visits),
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1))
#         annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
#                     labelx<- 0.8*max(sde$visits),
#                     labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
#                     size = 3, colour = "red"))
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
labelx<- 0.8*max(sde$visits)
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1))
#         annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
#                     labelx<- 0.8*max(sde$visits),
#                     labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
#                     size = 3, colour = "red"))
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
labelx<- 0.8*max(sde$visits)
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1))
}
#         annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
#                     labelx<- 0.8*max(sde$visits),
#                     labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
#                     size = 3, colour = "red"))
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
labelx<- 0.8*max(sde$visits)
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1)))
}
#         annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
#                     labelx<- 0.8*max(sde$visits),
#                     labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
#                     size = 3, colour = "red"))
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
for(i in 2:nlines){
labelx<- 0.8*max(sde$visits)
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 3, colour = "red")
}
#         annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
#                     labelx<- 0.8*max(sde$visits),
#                     labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
#                     size = 3, colour = "red"))
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)")
#         geom_text(data = NULL, x = labelx, y = labely,
#                     label = paste("QC = ", round(isoc[i], digits=1)),
#                     size = 4, colour = "red")
}
for(i in 2:nlines)  {
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
labelx<- 0.8*max(sde$visits),
labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
size = 3, colour = "red"))
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)")
#         geom_text(data = NULL, x = labelx, y = labely,
#                     label = paste("QC = ", round(isoc[i], digits=1)),
#                     size = 4, colour = "red")
}
for(i in 2:nlines)  {
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1+    annotate("text", label = paste("QC = ", round(isoc[i], digits=1),
labelx<- 0.8*max(sde$visits),
labely<- isoc[i]/(0.5*max(sde$eff_per_vis)),
size = 3, colour = "red"))
}
print(p1)
i
isoc[i]
0.8*max(sde$visits)
isoc[i]/(0.5*max(sde$eff_per_vis))
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)")
geom_text(data = NULL, x = labelx, y = labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
p1
labelx
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
labely<- isoc[i]/(0.5*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
labely<- isoc[i]/(0.25*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
labely<- isoc[i]/(0.6*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
p1<- ggplot(sde, aes(x=visits, y=eff_per_vis)) +
geom_point(shape=sde$group, size=5) +
geom_text(size=4, label=sde$animal,hjust=0.5, vjust=1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(sde$visits)
for(i in 2:nlines){
labely<- isoc[i]/(0.8*max(sde$eff_per_vis))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(sde$eff_per_vis)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
source('~/.active-rstudio-document', echo=TRUE)
# Function to plot effectiveness landscapes.
sde<- function (q1, q2, group, label, nlines=10){
nlines <- nlines # number of isolines wanted
# slope of a straight line linking (left,bottom) to (right,above)
# corners of the graphic
alfa <- max(q2)/max(q1)
# sequence of (nlines) regular spaced x values for the isoclines
xval <- seq(0, max(q1),
length.out=(nlines+1))[2:(nlines+1)]
isoc <- (xval*xval*alfa) # values of the isoclines
vis1<-seq(0,max(q1),length.out=1000)
#
pp<- as.data.frame(vis1) # Build dataset for within loop plot.
for(i in 1:nlines)
{
pp<- cbind(pp, isoc[i]/vis1)
}
# Main plot ----------------------------------------------------------------
require(devtools)
require(ggplot2)
# mytheme_bw.R
devtools::source_gist("https://gist.github.com/b843fbafa3af8f408972")
#
p1<- ggplot(aes(x=q1, y=q2)) +
geom_point(shape=group, size=5) +
geom_text(size= 4, label= label, hjust= 0.5, vjust= 1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(q1)
for(i in 2:nlines){
labely<- isoc[i]/(0.8*max(q2))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(q2)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
}
#---------------------------------------------------------------------------
sde <- read.table("data.txt", header=T, sep="\t", dec=".", na.strings="NA")
# Function to plot effectiveness landscapes.
effectiveness<- function (q1, q2, group, label, nlines=10){
nlines <- nlines # number of isolines wanted
# slope of a straight line linking (left,bottom) to (right,above)
# corners of the graphic
alfa <- max(q2)/max(q1)
# sequence of (nlines) regular spaced x values for the isoclines
xval <- seq(0, max(q1),
length.out=(nlines+1))[2:(nlines+1)]
isoc <- (xval*xval*alfa) # values of the isoclines
vis1<-seq(0,max(q1),length.out=1000)
#
pp<- as.data.frame(vis1) # Build dataset for within loop plot.
for(i in 1:nlines)
{
pp<- cbind(pp, isoc[i]/vis1)
}
# Main plot ----------------------------------------------------------------
require(devtools)
require(ggplot2)
# mytheme_bw.R
devtools::source_gist("https://gist.github.com/b843fbafa3af8f408972")
#
p1<- ggplot(aes(x=q1, y=q2)) +
geom_point(shape=group, size=5) +
geom_text(size= 4, label= label, hjust= 0.5, vjust= 1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(q1)
for(i in 2:nlines){
labely<- isoc[i]/(0.8*max(q2))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(q2)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
}
#---------------------------------------------------------------------------
effectiveness
names(sde)
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal)
sde <- read.table("data.txt", header=T, sep="\t", dec=".", na.strings="NA")
# Function to plot effectiveness landscapes.
effectiveness<- function (q1, q2, group, label, nlines=10){
require(devtools)
require(ggplot2)
#
nlines <- nlines # number of isolines wanted
# slope of a straight line linking (left,bottom) to (right,above)
# corners of the graphic
alfa <- max(q2)/max(q1)
# sequence of (nlines) regular spaced x values for the isoclines
xval <- seq(0, max(q1),
length.out=(nlines+1))[2:(nlines+1)]
isoc <- (xval*xval*alfa) # values of the isoclines
vis1<-seq(0,max(q1),length.out=1000)
#
pp<- as.data.frame(vis1) # Build dataset for within loop plot.
for(i in 1:nlines)
{
pp<- cbind(pp, isoc[i]/vis1)
}
# Main plot ----------------------------------------------------------------
# mytheme_bw.R
devtools::source_gist("https://gist.github.com/b843fbafa3af8f408972")
#
p1<- ggplot(aes(x=q1, y=q2)) +
geom_point(shape=group, size=5) +
geom_text(size= 4, label= label, hjust= 0.5, vjust= 1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(q1)
for(i in 2:nlines){
labely<- isoc[i]/(0.8*max(q2))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(q2)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
}
#---------------------------------------------------------------------------
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
source('~/.active-rstudio-document', echo=TRUE)
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
ls()
max(d$q2)
sde <- read.table("data.txt", header=T, sep="\t", dec=".", na.strings="NA")
# Function to plot effectiveness landscapes.
effectiveness<- function (q1, q2, group, label, nlines=10){
require(devtools)
require(ggplot2)
#
d<-as.data.frame(cbind(q1, q2, group, label))
names(d)
nlines <- nlines # number of isolines wanted
# slope of a straight line linking (left,bottom) to (right,above)
# corners of the graphic
alfa <- max(d$q2)/max(d$q1)
# sequence of (nlines) regular spaced x values for the isoclines
xval <- seq(0, max(d$q1),
length.out=(nlines+1))[2:(nlines+1)]
isoc <- (xval*xval*alfa) # values of the isoclines
vis1<-seq(0, max(d$q1), length.out= 1000)
#
pp<- as.data.frame(vis1) # Build dataset for within loop plot.
for(i in 1:nlines)
{
pp<- cbind(pp, isoc[i]/vis1)
}
# Main plot ----------------------------------------------------------------
# mytheme_bw.R
devtools::source_gist("https://gist.github.com/b843fbafa3af8f408972")
#
p1<- ggplot(data= d, aes(x=d$q1, y=d$q2)) +
geom_point(shape=d$group, size=5) +
geom_text(size= 4, label= label, hjust= 0.5, vjust= 1.9) +
mytheme_bw()
# Adding isolines
labelx<- 0.8*max(d$q1)
for(i in 2:nlines){
labely<- isoc[i]/(0.8*max(d$q2))
p1= p1 + geom_line(aes(x, y),
data= data.frame(x= pp$vis1, y= pp[,i]),
col="blue", size = 0.25, alpha= 0.6) +
ylim(0, max(d$q2)) +
xlab("Visit rate (/10h)") +
ylab("Effectiveness/visit (No. fruits handled/vis)") +
geom_text(data= NULL, x= labelx, y= labely,
label = paste("QC = ", round(isoc[i], digits=1)),
size = 4, colour = "red")
}
print(p1)
}
#---------------------------------------------------------------------------
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
source('~/.active-rstudio-document', echo=TRUE)
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
source('~/.active-rstudio-document', echo=TRUE)
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
source('~/.active-rstudio-document', echo=TRUE)
effectiveness(sde$visits, sde$eff_per_vis, sde$group, sde$animal, 5)
